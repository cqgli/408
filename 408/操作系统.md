# 计算机系统概述

## 计算机系统基本概念

#### 操作系统概念

1. 定义：控制和管理整个计算机系统的硬件和软件资源，合理的组织，调度计算机的工作与资源的分配，进而为用户和其他软件提供方便的接口和环境的程序集合

#### 操作系统的功能和目标

1. 操作系统作为计算机系统资源·的管理者
   1. 处理机管理：对进程的管理
   2. 存储器管理
   3. 文件管理
   4. 设备管理
2. 操作系统作为用户与计算机硬件系统之间的接口
   1. 命令接口
      1. 联机命令：交互式命令，执行一条命令
      2. 脱机命令：批处理命令，执行多个命令
   2. 程序接口
      1. 由一组系统调用组成
      2. 例：图形用户界面

#### 操作系统的特征

1. 并发
   1. 多个事件在同一个时间间隔内发生，**宏观的同时，微观不是同时**
2. 并行
   1. 同一时刻完成多个事件，同时
3. 共享
   1. 互斥共享
      1. 临界资源：一个资源不可以同时被两个进程访问
      2. 不同进程访问同一资源需要互相等待
      3. **不可在一个很短的时间内切换**
   2. 同时访问
      1. 在同一个时间间隔内，可以被不同进程访问，并发
      2. **在一个很短的时间内切换进程访问**
4. 虚拟
   1. **时分**：通过时间片虚拟化，实现“逻辑并行”，适合可分割的资源（如CPU）。
   2. **空分**：通过物理分区虚拟化，提供隔离性，适合需独占的资源（如内存）
5. 异步
   1. 多个进程并发进行，但是有时其他程序会堵塞

## 操作系统发展历程

#### 手工操作阶段

1. 缺点：用户独占全机，cpu利用不充分，效率低

#### 批处理阶段

1. 单道批处理
   1. 特点
      1. 自动性
      2. 顺序性
      3. 单道性
2. 多道批处理
   1. 特点
      1. 多道
      2. 宏观上并行
      3. 微观上串行
   2. 优点
      1. 资源利用率高
      2. 系统吞吐量大

#### 分时操作系统

1. 将cpu分成很多时间片，给不同的用户使用
2. 特点
   1. 同时性
   2. 交互性
   3. 独立性
   4. 及时性

#### 实时操作系统

1. 硬实时系统：某个动作必须在规定时间完成
2. 软实时系统：偶尔可以违反时间

#### 网络操作系统和分布式计算机

## 操作系统的运行环境

#### 处理器运行模式

1. 程序
   1. 内核程序
   2. 用户程序
2. 指令
   1. 特权指令
   2. 非特权指令
3. 运行状态
   1. 用户态
   2. 内核态
4. 时钟管理
5. 中断机制
6. 原语
   1. 位于操作系统底层
   2. 具有原子性
   3. 运行时间短
7. 系统控制的数据结构及处理
   1. 进程管理
   2. 存储器管理
   3. 设备管理

#### 中断和异常

1. 定义
   1. 中断：外中断，表示cpu执行指令的外部的事件
      1. 可屏蔽INTR
      2. 不可屏蔽NMI
   2. 异常：内中断，表示cpu执行指令内部的事件
      1. 故障
      2. 内陷
      3. 终止
2. 中断是在指令结束后检测，异常是指令执行时
3. 中断处理和子程序调用的比较
   1. 两者相互独立，没有明确关系
   2. 中断产生随机，子程序有call引起
   3. 子程序是软件处理，中断处理需要专门的硬件
   4. 中断地址有硬件向量法找到，子程序有call指令给出
   5. 两者都需要保护PC程序计数器

#### 系统调用

1. 定义：是操作系统提供给应用程序的接口。
2. 是一种特殊得到公共子程序
3. 功能
   1. 设备管理
   2. 文件管理
   3. 进程控制
   4. 进程通信
   5. 内存管理
4. 系统调用的过程
   1. 第一步
      1. 将系统调用号和所用参数压栈
      2. 执行陷入命令，转化为内核态
      3. 保护现场，PC，PSW，通用寄存器压栈
   2. 第二步
      1. 根据系统调用号找到处理子程序（系统调用的公共程序）的入口
   3. 第三步
      1. 恢复现场，返回中断进程或新进程
5. 常见的变态方式
   1. 系统调用
   2. 中断
   3. 发生错误
   4. 用户态执行特权命令

## 操作系统的结构

![image-20250601152446406](C:\Users\27545\AppData\Roaming\Typora\typora-user-images\image-20250601152446406.png)

## 操作系统引导

1. 过程
   1. 激活cpu，读取boot程序，执行BIOS内指令
   2. 硬件自检
   3. 加载带有操作系统的硬盘MBR，MBR引导区哪里找操作系统
   4. 扫描硬盘分区表，加载硬盘活动分区，MBR包含硬盘分区表
   5. 加载分区，引导记录PBR，PBR：分区引导记录，寻找并激活分区根目录的启动管理器
   6. 加载启动管理器
   7. 加载操作系统·

## 虚拟机

#### 基本概念

1. 利用虚拟化技术，将一台物理机器虚拟化为多台虚拟机器，通过特定的计算平台的实际物理特性，为用户提供抽象的，统一的，模拟的计算环境。
2. 第一类虚拟机
   1. 运行在最高特权级的程序
   2. 作为用户态的一个进程，不允许执行敏感指令
   3. 他的内核态为虚拟内核态
3. 第二类虚拟机
   1. 运行在宿主操作系统之上的操作系统

